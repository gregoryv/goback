<!DOCTYPE html>

<html>
<head>
<title>Golang; Backend development</title>
<style>html, body {
margin: 0 0;
padding: 0 0;
background-color: #fff;
}
.page {
height: 100vh;
position: relative;
margin-bottom: 1vh;
}
.page .view {
position: absolute;
top: 0;
left: 0;
right: 0;
bottom: 2vh;
}
.page .footer {
position: absolute;
bottom: 0;
left: 0;
right: 0;
text-align: center;
height: 2vh;
}
.page .view {
font-size: 2vw;
margin: 0 0;
padding: 0 0;
}
.page .view .header {
text-align: center;
height: 14vh;
overflow: hidden;
}
.header h1, .header h2, .header .group {
font-weight: bold;
margin-top: 3vh;
font-size: 5vh;
margin-bottom: 0vh;
}
.header h3 {
margin-top: 0vh;
font-size: 3vh;
}
.page .view .slide {
margin: auto;
padding: 0.8vw 1.6vw 0.8vw 1.6vw;
height: 79vh;
overflow: hidden;
}
.page .view .cover {
display: flex;
justify-content: center;
align-items: center;
height: 82vh;
text-align: center;
}
.toc {
position: absolute;
left: 20vw;
width: 55vw;
}
a {
text-decoration: none;
color: #000;
}
a:hover {
text-decoration: underline;
}
.h3 {
margin-left: 5vw;
list-style-type: circle;
}
.trail {
position: absolute;
height: 6px;
width: 6px;
border-radius: 3px;
background: teal;
}
.outline {
border: 1px solid black;
}
.center {
text-align: center;
}
.double {
}
.column.left {
position: absolute;
left: 4vw;
width: 40vw;
}
.column.right {
position: absolute;
left: 50vw;
width: 40vw;
}
.srcfile {
margin-top: 1.6em;
margin-bottom: 1.6em;
background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAlCAMAAAB1cTk3AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAjVBMVEX9/fz4+Pb19fP8/Pz39/Xp6ejr6+rs7Ov29vTt7evo6Oj6+vr7+/vv7+/u7u3v7+37+/ru7uzw8PD////29vbx8fD6+vjq6unz8/L5+ff39/f9/f3y8vHo6Ofx8fHw8O/z8/P6+vn4+Pj09PL+/v729vXp6efy8vDv7+709PTz8/H7+/n8/Pv5+fju7u5JBELWAAAAAWJLR0QB/wIt3gAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB+cFHw8tIWAQRK8AAAC5SURBVCjPpZDbEoIgEIaXQLPUNNFOWJrRyQ7v/3gJAs2EFzTuBex+8+/uDwDIiglgGyItJJ4/9YM+DxSczcMowvFCFgmk4lpmVEZeiGolYbCmKjZiQgp4i5C305CVPezOPTVxMLD6wrorj79K0U6kpaQxM0/GPIm5gmdilKise9ZI4UW96HoLGcN3ybpF+hPaomxV+oCn/Ukv4DZMgdqQOkMMb0clG4L5uO3/wAGf3Ll9UJk5Lxpr/gOpxRF8cA+lxgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMy0wNS0zMVQxMzo0NTozMyswMjowMJXHbJYAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjMtMDUtMzFUMTM6NDU6MzMrMDI6MDDkmtQqAAAAAElFTkSuQmCC);
background-repeat: repeat-y;
background-size: 20px;
padding-left: 16px;
background-color: #fafafa;
tab-size: 4;
-moz-tab-size: 4;
font-size: 2vh;
}
.srcfile code {
margin-left: 0px;
padding-right: 20px;
padding: .6em 0 0 0;
background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAlCAMAAAB1cTk3AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAjVBMVEX9/fz4+Pb19fP8/Pz39/Xp6ejr6+rs7Ov29vTt7evo6Oj6+vr7+/vv7+/u7u3v7+37+/ru7uzw8PD////29vbx8fD6+vjq6unz8/L5+ff39/f9/f3y8vHo6Ofx8fHw8O/z8/P6+vn4+Pj09PL+/v729vXp6efy8vDv7+709PTz8/H7+/n8/Pv5+fju7u5JBELWAAAAAWJLR0QB/wIt3gAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB+cFHw8tIWAQRK8AAAC5SURBVCjPpZDbEoIgEIaXQLPUNNFOWJrRyQ7v/3gJAs2EFzTuBex+8+/uDwDIiglgGyItJJ4/9YM+DxSczcMowvFCFgmk4lpmVEZeiGolYbCmKjZiQgp4i5C305CVPezOPTVxMLD6wrorj79K0U6kpaQxM0/GPIm5gmdilKise9ZI4UW96HoLGcN3ybpF+hPaomxV+oCn/Ukv4DZMgdqQOkMMb0clG4L5uO3/wAGf3Ll9UJk5Lxpr/gOpxRF8cA+lxgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMy0wNS0zMVQxMzo0NTozMyswMjowMJXHbJYAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjMtMDUtMzFUMTM6NDU6MzMrMDI6MDDkmtQqAAAAAElFTkSuQmCC);
background-repeat: repeat-y;
background-position: right top;
background-size: 20px;
display: block;
text-align: left;
font-family: Inconsolata, monospace;
overflow: hidden;
}
.srcfile ol {
margin-left: 0vw;
padding-left: 3vw;
}
.srcfile ol li {
white-space: pre;
}
.srcfile ol li::marker {
color: RGB(0,0,0,0.2);
}
.srcfile ol li:hover {
background-color: RGB(180,238,180,0.3);
}
.srcfile code i {
font-style: normal;
color: #a2a2a2;
}
.keyword {
color: darkviolet;
}
.type {
color: dodgerblue;
}
.comment, .comment>span {
color: darkgreen;
}
.header {
background-color: #f6f5f4;
border-bottom: 1px inset #000;
}
.page .footer {
bottom: 1vh;
}
.shell {
padding: 1em;
border-radius: 10px;
overflow: wrap;
}
.dark {
background-color: #2e2e34;
color: aliceblue;
}
nav {
column-count: 2;
font-size: 0.8em;
}
.srcfile ol {
padding-right: 40px;
}
.shell {
font-size: 1.5vw;
}
p>a {
text-decoration: underline;
}
quote {
display: inline-block;
font-style: italic;
padding-left: 2vw;
padding-right: 2vw;
font-size: 1.5vw;
}
quote>a {
font-size: 1vw;
float: right;
}
quote.small {
font-size: 1vw;
}
.pictogram {
width: 400px;
text-align: center;
padding: 1em 1em;
margin: 1em auto;
}
.pictogram label {
font-style: italic;
font-size: 0.6em;
}
.srcfile {
font-size: 1.3vw;
}
.filename {
display: block;
font-size: 0.8vw;
text-align: right;
margin-top: 2em;
margin-bottom: -2em;
}
.icons {
column-count: 3;
list-style-type: none;
}
.small * {
font-size: 0.9vw;
}
.right .srcfile, .right .shell, .right p {
margin-right: 1em;
}
.stop>img {
text-align: center;
float:left;
margin-right: 20px;
}
.stop>p {
padding-top: 50px;
color: red;
}
</style>
</head>
<body>
<div class="page" id="1"><div class="view"><div class="cover"><table>
<tr><td><h1>Golang; Backend development</h1>
</td></tr>
<tr><td>Gregory Vinčić</td></tr>
</table>
</div>
</div>
<div class="footer">1/27</div>
</div>
<div class="page" id="2"><div class="view"><div class="header"><h2>Golang; Backend development</h2>
</div>
<div class="slide"><div class="toc"><nav><ul>
<li class="h2"><a href="#3">Quick start</a></li>
<li class="h2"><a href="#4">Concepts</a></li>
<li class="h3"><a href="#5">module</a></li>
<li class="h3"><a href="#6">package</a></li>
<li class="h3"><a href="#7">interface</a></li>
<li class="h2"><a href="#8">HTTP</a></li>
<li class="h3"><a href="#9">direct</a></li>
<li class="h3"><a href="#10">closure</a></li>
<li class="h3"><a href="#11">method</a></li>
<li class="h3"><a href="#12">combo</a></li>
<li class="h2"><a href="#13">Route</a></li>
<li class="h3"><a href="#14">naive</a></li>
<li class="h3"><a href="#15">default http.ServeMux</a></li>
<li class="h3"><a href="#16">your own http.ServeMux</a></li>
<li class="h2"><a href="#17">Encode</a></li>
<li class="h3"><a href="#18">encoding/json</a></li>
<li class="h3"><a href="#19">nice json</a></li>
<li class="h3"><a href="#20">field tags</a></li>
<li class="h2"><a href="#21">Test</a></li>
<li class="h3"><a href="#22">http/httptest</a></li>
<li class="h3"><a href="#23">coverage</a></li>
<li class="h2"><a href="#24">View</a></li>
<li class="h3"><a href="#25">html/template</a></li>
<li class="h3"><a href="#26">embed</a></li>
<li class="h2"><a href="#27">Next time</a></li>
</ul>
</nav>
</div>
</div>
</div>
<div class="footer">2/27</div>
</div>
<div class="page" id="3"><div class="view"><div class="header"><h2>Quick start</h2>
</div>
<div class="slide"><div style="position: absolute; left: 15vw; width: 70vw"><p>Download and install Go in the $HOME directory.</p>
<pre class="shell dark">$ cd $HOME
$ wget https://go.dev/dl/go1.22.0.linux-amd64.tar.gz
$ tar xvfz go1.22.0.linux-amd64.tar.gz
$ export PATH="$PATH:$HOME/go/bin"
$ go version
go version go1.22.0 linux/amd64</pre><p>For more information refer to <a href="https://go.dev/doc/install">"Download and install"</a>.</p>
</div>
</div>
</div>
<div class="footer">3/27</div>
</div>
<div class="page" id="4"><div class="view"><div class="header"><h2>Concepts</h2>
</div>
<div class="slide"><div style="position: absolute; left: 15vw; width: 70vw"><p>In Go; <b>modules</b> are used to group
			<b>packages</b> and functions.</p>
<quote>"You can collect related packages into modules, then
		publish the modules for other developers to use."<br/><br/><a href="https://go.dev/doc/modules/developing">go.dev/doc/modules/developing</a></quote><br/><p>An <b>interface</b> describes behavior.</p>
<quote>"Interfaces in Go provide a way to specify the
			  behavior of an object: if something can do this, then it
			  can be used here."<br/><br/><a href="https://go.dev/doc/effective_go#interfaces_and_types">go.dev/doc/effective_go#interfaces_and_types</a></quote></div>
</div>
</div>
<div class="footer">4/27</div>
</div>
<div class="page" id="5"><div class="view"><div class="header"><div class="group">Concepts</div>
<h3>module</h3>
</div>
<div class="slide"><div class="double"><div class="column left" style="width: 42vw"><p>Modules are initiated using the reposity URL.</p>
<pre class="shell dark">$ go mod init github.com/gregoryv/uptime</pre><p>This can then be used</p>
<pre class="shell dark">$ go get github.com/gregoryv/uptime[@VERSION]</pre><p>Find modules on <a href="https://pkg.go.dev">pkg.go.dev</a></p>
</div>
<div class="column right" style="left: 50vw; width: 50vw"><p>Sharing code with others requires dependency
				management.</p>
<div class="pictogram"><img src="img/pic_module.png"/><br/><label>Pictogram of a Go module</label></div>
</div>
</div>
</div>
</div>
<div class="footer">5/27</div>
</div>
<div class="page" id="6"><div class="view"><div class="header"><div class="group">Concepts</div>
<h3>package</h3>
</div>
<div class="slide"><div class="double"><div class="column left" style="width: 42vw"><div class="srcfile"><code><ol>
<li><span class="keyword">package</span> main</li>
<li></li>
<li><span class="keyword">import</span> (</li>
<li>    "fmt"</li>
<li>    "time"</li>
<li></li>
<li>    "github.com/gregoryv/uptime"</li>
<li>)</li>
<li></li>
<li><span class="keyword">func</span> main() {</li>
<li>    start := time.Now()</li>
<li>    dur := uptime.Since(start)</li>
<li>    fmt.Println(dur.String())</li>
<li>}</li>
</ol>
</code></div>
</div>
<div class="column right" style="left: 50vw; width: 50vw"><br/><quote>"... package name should be good: short, concise, evocative. ...Use the package structure to help you choose good names. "<br/><br/><a href="https://go.dev/doc/effective_go#package-names">go.dev/doc/effective_go#package-names</a></quote><div class="pictogram"><img src="img/pic_package.png"/><br/><label>Pictogram of a Go package</label></div>
</div>
</div>
</div>
</div>
<div class="footer">6/27</div>
</div>
<div class="page" id="7"><div class="view"><div class="header"><div class="group">Concepts</div>
<h3>interface</h3>
</div>
<div class="slide"><div class="double"><div class="column left" style="width: 42vw"><br/><quote class="small">"Interfaces with only one or two methods are common in Go
			code, and are usually given a name derived from the
			method, such as io.Writer for something that implements
			Write."<br/><br/><a href="https://go.dev/doc/effective_go#interfaces_and_types">go.dev/doc/effective_go#interfaces_and_types</a></quote><div class="srcfile"><code><ol>
<li><span class="keyword">package</span> fmt</li>
<li></li>
<li><span class="keyword">type</span> Stringer <span class="keyword">interface</span> {</li>
<li>    String() string</li>
<li>}</li>
</ol>
</code></div>
<div class="pictogram"><img src="img/pic_interface.png"/><br/><label>Pictogram of a Go interface</label></div>
</div>
<div class="column right" style="left: 50vw; width: 50vw"><div class="srcfile"><code><ol start="7">
<li><span class="keyword">func</span> main() {</li>
<li>    fmt.Println(painted(color(2)))</li>
<li>}</li>
<li></li>
<li><span class="keyword">type</span> color int</li>
<li></li>
<li><span class="keyword">func</span> (c color) String() string {</li>
<li>    <span class="keyword">switch</span> c {</li>
<li>    <span class="keyword">case</span> 1:</li>
<li>        <span class="keyword">return</span> "red"</li>
<li>    <span class="keyword">case</span> 2:</li>
<li>        <span class="keyword">return</span> "green"</li>
<li>    <span class="keyword">default</span>:</li>
<li>        <span class="keyword">return</span> "white"</li>
<li>    }</li>
<li>}</li>
<li></li>
<li><span class="keyword">func</span> painted(value <span class="type">fmt.Stringer</span>) string {</li>
<li>    <span class="keyword">return</span> fmt.Sprintf("Painted: %s", value.String())</li>
<li>}</li>
</ol>
</code></div>
</div>
</div>
</div>
</div>
<div class="footer">7/27</div>
</div>
<div class="page" id="8"><div class="view"><div class="header"><h2>HTTP</h2>
</div>
<div class="slide"><div style="position: absolute; left: 16vw; width: 68vw"><p>Respond to HTTP requests in Go by implementing the
			http.Handler interface.</p>
<div class="srcfile"><code><ol>
<li><span class="keyword">package</span> http <span class="comment">// <span class="keyword">import</span> "net/http"</span></li>
<li></li>
<li><span class="comment">// A Handler responds to an HTTP request. Handler.ServeHTTP should</span></li>
<li><span class="comment">// write reply headers and data to the ResponseWriter and then <span class="keyword">return</span>.</span></li>
<li><span class="comment">// ...</span></li>
<li><span class="keyword">type</span> Handler <span class="keyword">interface</span> {</li>
<li>    ServeHTTP(ResponseWriter, *Request)</li>
<li>}</li>
<li></li>
<li><span class="comment">// The HandlerFunc <span class="keyword">type</span> is an adapter to allow the use of ordinary</span></li>
<li><span class="comment">// functions as HTTP handlers. If f is a function with the appropriate</span></li>
<li><span class="comment">// signature, HandlerFunc(f) is a Handler that calls f.</span></li>
<li><span class="keyword">type</span> HandlerFunc <span class="keyword">func</span>(ResponseWriter, *Request)</li>
<li></li>
<li><span class="keyword">func</span> (f HandlerFunc) ServeHTTP(w ResponseWriter, r *Request)</li>
</ol>
</code></div>
</div>
</div>
</div>
<div class="footer">8/27</div>
</div>
<div class="page" id="9"><div class="view"><div class="header"><div class="group">HTTP</div>
<h3>direct</h3>
</div>
<div class="slide"><div class="double"><div class="column left" style="width: 52vw"><div class="srcfile"><code><ol>
<li><span class="keyword">package</span> main</li>
<li></li>
<li><span class="keyword">import</span> (</li>
<li>    "fmt"</li>
<li>    "log"</li>
<li>    "net/http"</li>
<li>)</li>
<li></li>
<li><span class="keyword">func</span> main() {</li>
<li>    err := http.ListenAndServe(":8080", http.HandlerFunc(sayHello))</li>
<li>    <span class="keyword">if</span> err != nil {</li>
<li>        log.Fatal(err)</li>
<li>    }</li>
<li>}</li>
<li></li>
<li><span class="keyword">func</span> sayHello(w http.ResponseWriter, r *<span class="type">http.Request</span>) {</li>
<li>    fmt.Fprint(w, "Hello, world!")</li>
<li>}</li>
</ol>
</code></div>
</div>
<div class="column right" style="left: 60vw; width: 40vw"><p>Direct design uses named functions as http
                handlers, implementing the http.HandlerFunc
                interface</p>
<div class="pictogram"><img src="img/pic_func.png"/><br/><label>Func</label></div>
<span class="small"><pre class="shell dark">$ go run helloworld.go</pre></span></div>
</div>
</div>
</div>
<div class="footer">9/27</div>
</div>
<div class="page" id="10"><div class="view"><div class="header"><div class="group">HTTP</div>
<h3>closure</h3>
</div>
<div class="slide"><div class="double"><div class="column left" style="width: 52vw"><div class="srcfile"><code><ol>
<li><span class="keyword">package</span> main</li>
<li></li>
<li><span class="keyword">import</span> (</li>
<li>    "fmt"</li>
<li>    "log"</li>
<li>    "net/http"</li>
<li>)</li>
<li></li>
<li><span class="keyword">func</span> main() {</li>
<li>    <span class="keyword">if</span> err := http.ListenAndServe(":8080", sayHello()); err != nil {</li>
<li>        log.Fatal(err)</li>
<li>    }</li>
<li>}</li>
<li></li>
<li><span class="keyword">func</span> sayHello() http.HandlerFunc {</li>
<li>    txt := "Hello, world!"</li>
<li>    <span class="keyword">return</span> <span class="keyword">func</span>(w http.ResponseWriter, r *<span class="type">http.Request</span>) {</li>
<li>        fmt.Fprint(w, txt)</li>
<li>    }</li>
<li>}</li>
</ol>
</code></div>
</div>
<div class="column right" style="left: 60vw; width: 40vw"><p>Closure design uses named functions returning a
                http.Handler implementation</p>
<div class="pictogram"><img src="img/pic_closure.png"/><br/><label>Closure</label></div>
</div>
</div>
</div>
</div>
<div class="footer">10/27</div>
</div>
<div class="page" id="11"><div class="view"><div class="header"><div class="group">HTTP</div>
<h3>method</h3>
</div>
<div class="slide"><div class="double"><div class="column left" style="width: 52vw"><div class="srcfile"><code><ol>
<li><span class="keyword">package</span> main</li>
<li></li>
<li><span class="keyword">import</span> (</li>
<li>    "fmt"</li>
<li>    "log"</li>
<li>    "net/http"</li>
<li>)</li>
<li></li>
<li><span class="keyword">func</span> main() {</li>
<li>    <span class="keyword">if</span> err := http.ListenAndServe(":8080", &Greeter{}); err != nil {</li>
<li>        log.Fatal(err)</li>
<li>    }</li>
<li>}</li>
<li></li>
<li><span class="keyword">type</span> Greeter <span class="keyword">struct</span>{}</li>
<li></li>
<li><span class="keyword">func</span> (g *Greeter) ServeHTTP(w http.ResponseWriter, r *<span class="type">http.Request</span>) {</li>
<li>    fmt.Fprint(w, "Hello, world!")</li>
<li>}</li>
</ol>
</code></div>
</div>
<div class="column right" style="left: 60vw; width: 40vw"><p>Method design declares types that implement
				http.Handler</p>
<div class="pictogram"><img src="img/pic_method.png"/><br/><label>Method</label></div>
</div>
</div>
</div>
</div>
<div class="footer">11/27</div>
</div>
<div class="page" id="12"><div class="view"><div class="header"><div class="group">HTTP</div>
<h3>combo</h3>
</div>
<div class="slide"><div class="double"><div class="column left" style="width: 47vw"><span class="small"><div class="srcfile"><code><ol>
<li><span class="keyword">package</span> main</li>
<li></li>
<li><span class="keyword">import</span> (</li>
<li>    "fmt"</li>
<li>    "log"</li>
<li>    "net/http"</li>
<li>)</li>
<li></li>
<li><span class="keyword">func</span> main() {</li>
<li>    <span class="keyword">var</span> ctl Controller</li>
<li></li>
<li>    <span class="keyword">if</span> err := http.ListenAndServe(":8080", http.HandlerFunc(<span class="type">ctl.sayHello</span>)); err != nil {</li>
<li>        log.Fatal(err)</li>
<li>    }</li>
<li>}</li>
<li></li>
<li><span class="keyword">type</span> Controller <span class="keyword">struct</span>{}</li>
<li></li>
<li><span class="keyword">func</span> (c *Controller) sayHello(w http.ResponseWriter, r *<span class="type">http.Request</span>) {</li>
<li>    fmt.Fprint(w, "Hello, world!")</li>
<li>}</li>
</ol>
</code></div>
</span></div>
<div class="column right" style="left: 55vw; width: 45vw"><p>Combo design declares types with multiple methods
				that are either methods that either have a
				http.HandlerFunc signature or return one (closure).</p>
<div class="pictogram"><img src="img/pic_combined_closure.png"/><br/><label>Combo</label></div>
</div>
</div>
</div>
</div>
<div class="footer">12/27</div>
</div>
<div class="page" id="13"><div class="view"><div class="header"><h2>Route</h2>
</div>
<div class="slide"><div style="position: absolute; left: 16vw; width: 68vw"><p>For systems serving many resources</p>
<div class="srcfile"><code><ol>
<li><span class="keyword">package</span> http</li>
<li></li>
<li><span class="comment">// ServeMux is an HTTP request multiplexer. It matches the URL of each</span></li>
<li><span class="comment">// incoming request against a list of registered patterns and calls</span></li>
<li><span class="comment">// the handler <span class="keyword">for</span> the pattern that most closely matches the URL.</span></li>
<li><span class="keyword">type</span> ServeMux <span class="keyword">struct</span> {</li>
<li>    <span class="comment">// Has unexported fields.</span></li>
<li>}</li>
</ol>
</code></div>
<pre>multiplexer
      n 1: a device that can interleave two or more activities
</pre></div>
</div>
</div>
<div class="footer">13/27</div>
</div>
<div class="page" id="14"><div class="view"><div class="header"><div class="group">Route</div>
<h3>naive</h3>
</div>
<div class="slide"><div class="double"><div class="column left" style="width: 55vw"><div class="srcfile"><code><ol start="16">
<li><span class="keyword">func</span> (c *Controller) ServeHTTP(w http.ResponseWriter, r *<span class="type">http.Request</span>) {</li>
<li>    <span class="keyword">switch</span> {</li>
<li>    <span class="keyword">case</span> r.URL.Path == "/" && r.Method == "GET":</li>
<li>        c.sayHello(w, r)</li>
<li></li>
<li>    <span class="keyword">case</span> r.URL.Path == "/bye" && r.Method == "GET":</li>
<li>        c.sayGoodbye(w, r)</li>
<li></li>
<li>    <span class="keyword">default</span>:</li>
<li>        http.Error(w, "routing failed", <span class="type">http.StatusBadRequest</span>)</li>
<li>    }</li>
<li>}</li>
</ol>
</code></div>
</div>
<div class="column right" style="left: 63vw; width: 37vw"><p>Manual routing.</p>
<div class="stop"><img src="img/stop.png"/><p>Error prone and complex.</p>
</div>
</div>
</div>
</div>
</div>
<div class="footer">14/27</div>
</div>
<div class="page" id="15"><div class="view"><div class="header"><div class="group">Route</div>
<h3>default http.ServeMux</h3>
</div>
<div class="slide"><div class="double"><div class="column left" style="width: 62vw"><div class="srcfile"><code><ol start="9">
<li><span class="keyword">func</span> main() {</li>
<li>    <span class="keyword">var</span> ctl Controller</li>
<li>    http.HandleFunc("GET /", <span class="type">ctl.sayHello</span>)</li>
<li>    http.HandleFunc("GET /bye", <span class="type">ctl.sayGoodbye</span>)</li>
<li>    <span class="keyword">if</span> err := http.ListenAndServe(":8080", nil); err != nil {</li>
<li>        log.Fatal(err)</li>
<li>    }</li>
<li>}</li>
<li></li>
<li><span class="keyword">type</span> Controller <span class="keyword">struct</span>{}</li>
<li></li>
<li><span class="keyword">func</span> (c *Controller) sayHello(w http.ResponseWriter, r *<span class="type">http.Request</span>) {</li>
<li>    fmt.Fprint(w, "Hello, world!")</li>
<li>}</li>
<li></li>
<li><span class="keyword">func</span> (c *Controller) sayGoodbye(w http.ResponseWriter, r *<span class="type">http.Request</span>) {</li>
<li>    fmt.Fprint(w, "Goodbye, world!")</li>
<li>}</li>
</ol>
</code></div>
</div>
<div class="column right" style="left: 70vw; width: 30vw"><p>Use http singleton ServeMux.</p>
</div>
</div>
</div>
</div>
<div class="footer">15/27</div>
</div>
<div class="page" id="16"><div class="view"><div class="header"><div class="group">Route</div>
<h3>your own http.ServeMux</h3>
</div>
<div class="slide"><div class="double"><div class="column left" style="width: 62vw"><ul class="srcfile">
<code><ol>
<li><span class="keyword">func</span> main() {</li>
<li>    <span class="keyword">var</span> ctl Controller</li>
<li></li>
<li>    mux := http.NewServeMux()</li>
<li>    mux.HandleFunc("GET /", <span class="type">ctl.sayHello</span>)</li>
<li>    mux.HandleFunc("GET /bye", <span class="type">ctl.sayGoodbye</span>)</li>
<li></li>
<li>    <span class="keyword">if</span> err := http.ListenAndServe(":8080", mux); err != nil {</li>
<li>        log.Fatal(err)</li>
<li>    }</li>
<li>}</li>
</ol>
</code></ul>
</div>
<div class="column right" style="left: 70vw; width: 30vw"><p>Create your own http.ServeMux.</p>
</div>
</div>
</div>
</div>
<div class="footer">16/27</div>
</div>
<div class="page" id="17"><div class="view"><div class="header"><h2>Encode</h2>
</div>
<div class="slide"><div style="position: absolute; left: 20vw; width: 60vw"><p>From the dictionary</p>
<pre>encode
  
    &lt;algorithm, hardware&gt; To convert {data} or some physical
    quantity into a given format.  E.g. {uuencode}.
</pre><p>In Go this means convert <code>type X</code> to <code>[]byte</code></p>
</div>
</div>
</div>
<div class="footer">17/27</div>
</div>
<div class="page" id="18"><div class="view"><div class="header"><div class="group">Encode</div>
<h3>encoding/json</h3>
</div>
<div class="slide"><div class="double"><div class="column left" style="width: 52vw"><div class="srcfile"><code><ol>
<li><span class="keyword">package</span> main</li>
<li></li>
<li><span class="keyword">import</span> (</li>
<li>    "encoding/json"</li>
<li>    "fmt"</li>
<li>)</li>
<li></li>
<li><span class="keyword">func</span> main() {</li>
<li>    user := Contact{</li>
<li>        Firstname: "John",</li>
<li>        Lastname:  "Doe",</li>
<li>    }</li>
<li>    data, _ := json.Marshal(user)</li>
<li>    fmt.Print(string(data))</li>
<li>}</li>
<li></li>
<li><span class="keyword">type</span> Contact <span class="keyword">struct</span> {</li>
<li>    Firstname string</li>
<li>    Lastname  string</li>
<li>}</li>
</ol>
</code></div>
</div>
<div class="column right" style="left: 60vw; width: 40vw"><pre class="shell dark">$ go run ./examples/encoding.go<br/>{"Firstname":"John","Lastname":"Doe"}</pre></div>
</div>
</div>
</div>
<div class="footer">18/27</div>
</div>
<div class="page" id="19"><div class="view"><div class="header"><div class="group">Encode</div>
<h3>nice json</h3>
</div>
<div class="slide"><div class="double"><div class="column left" style="width: 52vw"><div class="srcfile"><code><ol>
<li><span class="keyword">package</span> main</li>
<li></li>
<li><span class="keyword">import</span> (</li>
<li>    "encoding/json"</li>
<li>    "fmt"</li>
<li>)</li>
<li></li>
<li><span class="keyword">func</span> main() {</li>
<li>    user := Contact{</li>
<li>        Firstname: "John",</li>
<li>        Lastname:  "Doe",</li>
<li>    }</li>
<li>    data, _ := json.MarshalIndent(user, "", "  ")</li>
<li>    fmt.Print(string(data))</li>
<li>}</li>
<li></li>
<li><span class="keyword">type</span> Contact <span class="keyword">struct</span> {</li>
<li>    Firstname string</li>
<li>    Lastname  string</li>
<li>}</li>
</ol>
</code></div>
</div>
<div class="column right" style="left: 60vw; width: 40vw"><pre class="shell dark">$ go run ./examples/nicejson.go<br/>{
  "Firstname": "John",
  "Lastname": "Doe"
}</pre></div>
</div>
</div>
</div>
<div class="footer">19/27</div>
</div>
<div class="page" id="20"><div class="view"><div class="header"><div class="group">Encode</div>
<h3>field tags</h3>
</div>
<div class="slide"><div class="double"><div class="column left" style="width: 52vw"><div class="srcfile"><code><ol>
<li><span class="keyword">package</span> main</li>
<li></li>
<li><span class="keyword">import</span> (</li>
<li>    "encoding/json"</li>
<li>    "fmt"</li>
<li>)</li>
<li></li>
<li><span class="keyword">func</span> main() {</li>
<li>    user := Contact{</li>
<li>        Firstname: "John",</li>
<li>        Lastname:  "Doe",</li>
<li>    }</li>
<li>    data, _ := json.MarshalIndent(user, "", "  ")</li>
<li>    fmt.Print(string(data))</li>
<li>}</li>
<li></li>
<li><span class="keyword">type</span> Contact <span class="keyword">struct</span> {</li>
<li>    Firstname string `json:"firstname"`</li>
<li>    Lastname  string `json:"lastname"`</li>
<li>}</li>
</ol>
</code></div>
</div>
<div class="column right" style="left: 60vw; width: 40vw"><p>Control naming of fields, eg. lowercase names.</p>
<pre class="shell dark">$ go run ./examples/fieldtags.go<br/>{
  "firstname": "John",
  "lastname": "Doe"
}</pre></div>
</div>
</div>
</div>
<div class="footer">20/27</div>
</div>
<div class="page" id="21"><div class="view"><div class="header"><h2>Test</h2>
</div>
<div class="slide"><div class="double"><div class="column left" style="width: 42vw"><div class="filename">main_test.go</div>
<div class="srcfile"><code><ol>
<li><span class="keyword">package</span> main</li>
<li></li>
<li><span class="keyword">import</span> "testing"</li>
<li></li>
<li><span class="keyword">func</span> TestSum(t *<span class="type">testing.T</span>) {</li>
<li>    <span class="keyword">if</span> s := Sum(1, 2); s != 3 {</li>
<li>        t.Errorf("got %v, expect 3", s)</li>
<li>    }</li>
<li>}</li>
</ol>
</code></div>
<div class="filename">main.go</div>
<div class="srcfile"><code><ol start="6">
<li><span class="keyword">func</span> Sum(a, b int) int {</li>
<li>    <span class="keyword">return</span> a + b</li>
<li>}</li>
</ol>
</code></div>
</div>
<div class="column right" style="left: 50vw; width: 50vw"><pre>.
├── go.mod
├── main.go
└── main_test.go

0 directories, 3 files
</pre><pre class="shell dark">$ go test -v .<br/>=== RUN   TestSum
--- PASS: TestSum (0.00s)
PASS
ok  	github.com/gregoryv/project	0.001s
</pre></div>
</div>
</div>
</div>
<div class="footer">21/27</div>
</div>
<div class="page" id="22"><div class="view"><div class="header"><div class="group">Test</div>
<h3>http/httptest</h3>
</div>
<div class="slide"><div class="double"><div class="column left" style="width: 52vw"><div class="srcfile"><code><ol>
<li><span class="keyword">package</span> main</li>
<li></li>
<li><span class="keyword">import</span> (</li>
<li>    "net/http"</li>
<li>    "net/http/httptest"</li>
<li>    "testing"</li>
<li>)</li>
<li></li>
<li><span class="keyword">func</span> Test_sayHello(t *<span class="type">testing.T</span>) {</li>
<li>    <span class="comment">// prepare response recorder and request</span></li>
<li>    w := httptest.NewRecorder()</li>
<li>    r := httptest.NewRequest("GET", "/", <span class="type">http.NoBody</span>)</li>
<li></li>
<li>    <span class="comment">// call handler</span></li>
<li>    handler := sayHello() <span class="comment">// using the closure design</span></li>
<li>    handler(w, r)</li>
<li></li>
<li>    <span class="comment">// check result</span></li>
<li>    resp := w.Result()</li>
<li>    <span class="keyword">if</span> v := resp.StatusCode; v != 200 {</li>
<li>        t.Error(<span class="type">resp.Status</span>)</li>
<li>    }</li>
<li>}</li>
</ol>
</code></div>
</div>
<div class="column right" style="left: 60vw; width: 40vw"><p>Quick unit test of specific handlers using httptest.Recorder</p>
</div>
</div>
</div>
</div>
<div class="footer">22/27</div>
</div>
<div class="page" id="23"><div class="view"><div class="header"><div class="group">Test</div>
<h3>coverage</h3>
</div>
<div class="slide"></div>
</div>
<div class="footer">23/27</div>
</div>
<div class="page" id="24"><div class="view"><div class="header"><h2>View</h2>
</div>
<div class="slide"></div>
</div>
<div class="footer">24/27</div>
</div>
<div class="page" id="25"><div class="view"><div class="header"><div class="group">View</div>
<h3>html/template</h3>
</div>
<div class="slide"><p></p>
</div>
</div>
<div class="footer">25/27</div>
</div>
<div class="page" id="26"><div class="view"><div class="header"><div class="group">View</div>
<h3>embed</h3>
</div>
<div class="slide"></div>
</div>
<div class="footer">26/27</div>
</div>
<div class="page" id="27"><div class="view"><div class="header"><h2>Next time</h2>
</div>
<div class="slide"><pre>
Design patterns
  - access control

Benchmarking
Logging
Error handling

</pre></div>
</div>
<div class="footer">27/27</div>
</div>
</body>
<script>document.addEventListener('keydown', function(event) {
    if (previousPageKey(event)) {
	event.preventDefault()		
	previousPage()
	return
    }
    if (nextPageKey(event)) {
	event.preventDefault()
	nextPage()
	return
    }
    if (event.key === 'Home') {
	pageIndex = 1
	event.preventDefault()
	window.location.hash = pageIndex	
    }
    if (event.key === 'End') {
	pageIndex = last
	event.preventDefault()
	window.location.hash = pageIndex	
    }
    if (event.key === 't') {
	pageIndex = 2 // toc
	event.preventDefault()
	window.location.hash = pageIndex	
    }
    return
})

window.addEventListener('resize', function() {
    window.location.hash = getPos()
});

const last = document.querySelectorAll('.page').length;

function previousPage() {
    let pageIndex = getPos()
    if (pageIndex > 1) {
	pageIndex--
	window.location.hash = pageIndex
    }
}

function nextPage() {
    let pageIndex = getPos()
    if (pageIndex < last) {
	pageIndex++
	window.location.hash = pageIndex
    }
}

function previousPageKey(event) {
    return event.key === 'ArrowLeft' ||
	    event.key === 'ArrowUp' ||
	    event.key === 'PageUp'
}

function nextPageKey(event) {
    return event.key === 'ArrowRight' ||
	    event.key === 'ArrowDown' ||
	    event.key === 'PageDown'
}

function getPos() {
    let currentView = window.location.hash
    if (currentView === '') {
	currentView = "#1"
    }
    return parseInt(currentView.split('#').join(''))
}

// dots is an array of Dot objects,
// mouse is an object used to track the X and Y position
   // of the mouse, set with a mousemove event listener below
var dots = [],
    mouse = {
      x: 0,
      y: 0
    };

// The Dot object used to scaffold the dots
var Dot = function() {
  this.x = 0;
  this.y = 0;
  this.node = (function(){
    var n = document.createElement("div");
    n.className = "trail";
    document.body.appendChild(n);
    return n;
  }());
};
// The Dot.prototype.draw() method sets the position of 
  // the object's <div> node
Dot.prototype.draw = function() {
  this.node.style.left = this.x + "px";
  this.node.style.top = this.y + "px";
};

// Creates the Dot objects, populates the dots array
for (var i = 0; i < 12; i++) {
  var d = new Dot();
  dots.push(d);
}

// This is the screen redraw function
function draw() {
  // Make sure the mouse position is set everytime
    // draw() is called.
  var x = mouse.x,
      y = mouse.y;
  
  // This loop is where all the 90s magic happens
  dots.forEach(function(dot, index, dots) {
    var nextDot = dots[index + 1] || dots[0];
    
    dot.x = x;
    dot.y = y;
    dot.draw();
    x += (nextDot.x - dot.x) * .6;
    y += (nextDot.y - dot.y) * .6;

  });
}

addEventListener("mousemove", function(event) {
  //event.preventDefault();
  mouse.x = event.pageX;
  mouse.y = event.pageY;
});

// animate() calls draw() then recursively calls itself
  // everytime the screen repaints via requestAnimationFrame().
function animate() {
  draw();
  requestAnimationFrame(animate);
}

// And get it started by calling animate().
animate();
</script>
</html>
